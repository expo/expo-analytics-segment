{"version":3,"file":"Segment.js","sourceRoot":"","sources":["../src/Segment.ts"],"names":[],"mappings":"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","sourcesContent":["import { UnavailabilityError } from 'expo-modules-core';\nimport { Platform } from 'react-native';\n\nimport ExponentSegment from './ExponentSegment';\n\n// @needsAudit\nexport type InitializeOptions = {\n  /**\n   * Write key for Android source.\n   */\n  androidWriteKey?: string;\n  /**\n   * Write key for iOS source.\n   */\n  iosWriteKey?: string;\n};\n\nexport type CommonOptions = Record<string, any> | null;\n\n// @needsAudit\n/**\n * Segment requires separate write keys for iOS and Android. You will need to log in to Segment\n * to receive these keys: [https://segment.com/docs/guides/setup/how-do-i-find-my-write-key/](https://segment.com/docs/guides/setup/how-do-i-find-my-write-key/)\n *\n * @param options An [`InitializeOptions`](#initializeoptions) object.\n */\nexport function initialize(options: InitializeOptions): void {\n  if (!ExponentSegment.initialize) {\n    throw new UnavailabilityError('expo-analytics-segment', 'initialize');\n  }\n  const platformWriteKey = Platform.select({\n    ios: options.iosWriteKey,\n    android: options.androidWriteKey,\n  });\n  if (platformWriteKey) {\n    ExponentSegment.initialize(platformWriteKey);\n  } else {\n    throw new Error('You must provide a platform-specific write key to initialize Segment.');\n  }\n}\n\n// @needsAudit\n/**\n * Associates the current user with a user ID. Call this after calling [`Segment.initialize()`](#initialize)\n * but before other segment calls. See [Segment Identify docs](https://segment.com/docs/spec/identify/).\n * @param userId User ID for the current user.\n */\nexport function identify(userId: string): void {\n  if (!ExponentSegment.identify) {\n    throw new UnavailabilityError('expo-analytics-segment', 'identify');\n  }\n  ExponentSegment.identify(userId);\n}\n\n// @needsAudit @docsMissing\n/**\n * @param userId User ID for the current user.\n * @param traits A map of custom properties.\n * @param options Map that can include any of [these common fields](https://segment.com/docs/connections/spec/common/).\n * Defaults to `null`.\n */\nexport function identifyWithTraits(\n  userId: string,\n  traits: Record<string, any>,\n  options: CommonOptions = null\n): void {\n  if (!ExponentSegment.identifyWithTraits) {\n    throw new UnavailabilityError('expo-analytics-segment', 'identifyWithTraits');\n  }\n  ExponentSegment.identifyWithTraits(userId, traits, options);\n}\n\n// @needsAudit\n/**\n * Associate the user with a group. See [Segment Group docs](https://segment.com/docs/spec/group/).\n *\n * @param groupId ID of the group.\n */\nexport function group(groupId: string): void {\n  if (!ExponentSegment.group) {\n    throw new UnavailabilityError('expo-analytics-segment', 'group');\n  }\n  ExponentSegment.group(groupId);\n}\n\n// @needsAudit\n/**\n * Associate the user with a group with traits. See [Segment Group docs](https://segment.com/docs/spec/group/).\n *\n * @param groupId ID of the group.\n * @param traits Free-form dictionary of traits of the group.\n * @param options A map that can include any of [these common fields](https://segment.com/docs/connections/spec/common/).\n * Defaults to `null`.\n */\nexport function groupWithTraits(\n  groupId: string,\n  traits: Record<string, any>,\n  options: CommonOptions = null\n): void {\n  if (!ExponentSegment.groupWithTraits) {\n    throw new UnavailabilityError('expo-analytics-segment', 'groupWithTraits');\n  }\n  ExponentSegment.groupWithTraits(groupId, traits, options);\n}\n\n// @needsAudit\n/**\n * Associate current identity with a new identifier. See [Segment Alias docs](https://segment.com/docs/spec/alias/).\n *\n * @param newId Identifier to associate with.\n * @param options An extra dictionary with options for the call, [see here](https://segment.com/docs/connections/spec/common/)\n * for possible configuration options. An example options object would be:\n * ```json\n * {\n *   \"integrations\": {\n *     \"Sentry\": {\n *       \"enabled\": true\n *      }\n *   },\n *   \"context\": {\n *     \"ip\": \"0.0.0.0\"\n *   }\n * }\n * ```\n *\n * @return A `Promise` which fulfils witch a `boolean` indicating whether the method has been\n * executed on the underlying `Segment` instance or not.\n */\nexport async function alias(newId: string, options: CommonOptions = null): Promise<boolean> {\n  if (!ExponentSegment.alias) {\n    throw new UnavailabilityError('expo-analytics-segment', 'alias');\n  }\n  return await ExponentSegment.alias(newId, options);\n}\n\n// @needsAudit\n/**\n * Clears the current user. See [https://segment.com/docs/sources/mobile/ios/#reset](https://segment.com/docs/sources/mobile/ios/#reset).\n */\nexport function reset(): void {\n  if (!ExponentSegment.reset) {\n    throw new UnavailabilityError('expo-analytics-segment', 'reset');\n  }\n  ExponentSegment.reset();\n}\n\n// @needsAudit\n/**\n * Log an event to Segment. See [Segment Track docs](https://segment.com/docs/spec/track/).\n *\n * @param event The event name.\n */\nexport function track(event: string): void {\n  if (!ExponentSegment.track) {\n    throw new UnavailabilityError('expo-analytics-segment', 'track');\n  }\n  ExponentSegment.track(event);\n}\n\n// @needsAudit\n/**\n * Log an event to Segment with custom properties. See [Segment Track docs](https://segment.com/docs/spec/track/).\n *\n * @param event The event name.\n * @param properties A map of custom properties.\n * @param options A map that can include any of [these common fields](https://segment.com/docs/connections/spec/common/).\n * Defaults to `null`.\n */\nexport function trackWithProperties(\n  event: string,\n  properties: Record<string, any>,\n  options: CommonOptions = null\n): void {\n  if (!ExponentSegment.trackWithProperties) {\n    throw new UnavailabilityError('expo-analytics-segment', 'trackWithProperties');\n  }\n  ExponentSegment.trackWithProperties(event, properties, options);\n}\n\n// @needsAudit\n/**\n * Record that a user has seen a screen to Segment. See [Segment Screen docs](https://segment.com/docs/spec/screen/).\n *\n * @param screenName Name of the screen.\n */\nexport function screen(screenName: string): void {\n  if (!ExponentSegment.screen) {\n    throw new UnavailabilityError('expo-analytics-segment', 'screen');\n  }\n  ExponentSegment.screen(screenName);\n}\n\n// @needsAudit\n/**\n * Record that a user has seen a screen to Segment with custom properties. See [Segment Screen docs](https://segment.com/docs/spec/screen/).\n *\n * @param screenName Name of the screen.\n * @param properties A map of custom properties.\n * @param options A map that can include any of [these common fields](https://segment.com/docs/connections/spec/common/).\n * Defaults to `null`.\n */\nexport function screenWithProperties(\n  screenName: string,\n  properties: Record<string, any>,\n  options: CommonOptions = null\n): void {\n  if (!ExponentSegment.screenWithProperties) {\n    throw new UnavailabilityError('expo-analytics-segment', 'screenWithProperties');\n  }\n  ExponentSegment.screenWithProperties(screenName, properties, options);\n}\n\n// @needsAudit\n/**\n * Manually flush the event queue. You shouldn't need to call this in most cases.\n */\nexport function flush(): void {\n  if (!ExponentSegment.flush) {\n    throw new UnavailabilityError('expo-analytics-segment', 'flush');\n  }\n  ExponentSegment.flush();\n}\n\n// @missingDocs\nexport async function getEnabledAsync(): Promise<boolean> {\n  if (!ExponentSegment.getEnabledAsync) {\n    throw new UnavailabilityError('expo-analytics-segment', 'getEnabledAsync');\n  }\n  const isEnabledNumber = await ExponentSegment.getEnabledAsync();\n  return !!isEnabledNumber;\n}\n\n// @missingDocs\nexport async function setEnabledAsync(enabled: boolean): Promise<void> {\n  if (!ExponentSegment.setEnabledAsync) {\n    throw new UnavailabilityError('expo-analytics-segment', 'setEnabledAsync');\n  }\n  await ExponentSegment.setEnabledAsync(enabled);\n}\n"]}